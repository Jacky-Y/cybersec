package client;

import server.HelloImpl;
import server.IHello;

import javax.naming.Context;
import javax.naming.InitialContext;
import javax.naming.NamingException;
import java.rmi.RemoteException;
import java.util.Hashtable;


public class JNDIClientmod {
    public static void main(String[] args) {
        try {
            // 创建属性 Hashtable
            Hashtable<String, String> env = new Hashtable<>();
            env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.rmi.registry.RegistryContextFactory");
            env.put(Context.PROVIDER_URL, "rmi://127.0.0.1:1099");


            // 创建 JNDI 上下文
            Context context = new InitialContext(env);

            IHello localh=new HelloImpl2();

//            context.bind("HelloService",localh);

            // 查找远程对象


//            context.lookup("HelloService");

            IHello hello = (IHello) context.lookup("HelloService");
            hello.sayHello("Dddd");


            // 调用远程方法
//            String result = hello.sayHello("John");
//
//            System.out.println("Result: " + result);
        } catch (NamingException e) {
            e.printStackTrace();
        } catch (RemoteException e) {
            throw new RuntimeException(e);
        }
    }
}